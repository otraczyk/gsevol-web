{% extends 'base.html' %}
{% load staticfiles %}

{% block scripts %}
{{ block.super }}
    <script src="{% static 'main.js' %}"></script>
    <script src="{% static 'lists.js' %}"></script>
    <script src="{% static 'results.js' %}"></script>
    <script src="{% static 'unrooted.js' %}"></script>
    <script src="{% static 'rooted.js' %}"></script>
    <script>
        $(function(){
            var app = React.render(
                React.createElement(Nav, {}),
                document.getElementById('nav')
            );
        })
    </script>
    {% if show_results %}
    <script>
    $(function(){
        var app = React.render(
            React.createElement({{ result_component }}, {}),
            document.getElementById('results')
        );
    })
    </script>
    <script>
    var ws = new WebSocket(
        'ws://' + location.host + '/ws/' + location.search.slice(1)
        + '?subscribe-broadcast&publish-broadcast&echo');
    ws.onopen = function() {
        console.log("websocket connected");
    };
    ws.onmessage = function(e) {
        console.log("Received: " + e.data);
    };
    ws.onerror = function(e) {
        console.error(e);
    };
    ws.onclose = function(e) {
        console.log("connection closed");
    }
    function send_message(msg) {
        ws.send(msg);
    }
    </script>
    {% endif %}
{% endblock %}

{% block content %}
    {% include form_template %}
    <d1iv id="results">
    </div>
{% endblock %}

